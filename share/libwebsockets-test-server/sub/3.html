
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>WebSocket Example</title>
</head>
<body>
<button id="connectButton">Connect JSON Data</button>
    <button id="sendButton">Send JSON Data</button>

    <script>
        // 创建一个 WebSocket 连接
        var socket;

        // 当点击 "Send JSON Data" 按钮时触发的事件处理程序
        document.getElementById('connectButton').addEventListener('click', function () {

socket = new WebSocket('ws://localhost:7681', 'api');

        // 当连接建立时触发的回调函数
        socket.addEventListener('open', function (event) {
            console.log('Connection established');
        });

        // 当从服务器接收到消息时触发的回调函数
        socket.addEventListener('message', function (event) {

            var data = JSON.parse(event.data); // 假设服务器发送的是 JSON 格式的数据

            // 在控制台上打印接收到的数据
            console.log('Received message:' + JSON.stringify(data));
        });

        // 当发生错误时触发的回调函数
        socket.addEventListener('error', function (event) {
            console.error('Error occurred:', event);
        });

        // 当连接关闭时触发的回调函数
        socket.addEventListener('close', function (event) {
            console.log('Connection closed');
        });
        });
        // 当点击 "Send JSON Data" 按钮时触发的事件处理程序
        document.getElementById('sendButton').addEventListener('click', function () {
            // 创建一个要发送的 JSON 对象
            var data = {
                action: '/system/version',
                msgid: 'msgid1234567890',
                data: {
                  arg1:"arg1",
                  arg2:"arg2",
                  arg3:"arg3",
                  arg4:"arg4",
                  arg5:"arg5"
          }
            };

            // 将 JSON 对象转换为字符串，并发送给服务器
            str = JSON.stringify(data);
            console.log("send:" + str)
            //for (i = 0; i < 1000000000000; i++) {
            //socket.send(str);
            //}
            
                            // 定义发送数据的间隔时间（单位：毫秒）
        var sendInterval = 1; // 每隔5秒发送一次数据

        // 开始定时发送数据
        setInterval(function () {
            // 将 JSON 对象转换为字符串，并发送给服务器
            socket.send(JSON.stringify(data));
            console.log('Sent message:', data);
        }, sendInterval);
        
        
        });
        
        

        
        
    </script>
</body>
</html>

